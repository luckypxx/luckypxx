---
layout: post
title:进程
date: 2018-09-12
tag: 操作系统
--- 

### 冯诺依曼体系结构

- 组成

包括输入单元、输入设备、存储器、运算器、控制器、输出单元、输出设备

存储器更多指的是内存

- 关于冯诺依曼

a.CPU只能对内存进行读写，不能访问外设

b.外设要读入或输出数据，只能写入内存或者从内存中读取，即所有外设只能和内存打交道

### 操作系统

- 概念

操作系统包括：内核(进程管理、内存管理、文件管理、驱动管理)和其他程序(函数库、shell程序等)

- 设计操作系统的目的

a.与硬件交互，管理所有的软件和硬件

b.为用户提供一个良好的执行环境

- 管理的概念

即先将被管理对象描述起来，再将被管理对象组织起来

假如硬盘中存着一个程序，对程序进行编译后会生成一个可执行文件，而这个可执行文件就会加载到内存中供操作系统读取，但在内存中的仅仅是代码和数据。一个程序会生成一个进程，那么在操作系统中就会维护一个结构体(PCB)，结构体中该程序的属性。操作系统中不只有一个进程，那么就会产生多个结构体，为了方便管理，使用链表来将这些结构体连接起来，这是操作系统只需要知道该链表的头结点。

### 进程

进程之间是互相**独立**的，虽然代码有可能相同，但是各个进程都在维护各自的数据，因此进程之间是互不干扰的

- 进程的控制块---PCB

PCB包含一些字段，字段中包含程序的数据

- 进程的字段

pid（唯一标识符）、优先级、状态、

- 进程的状态

在不同的操作系统中，进程的状态是不同的

> - **R**(unning)---可执行状态
>
> - **S**(leep)---休眠状态
>
> - **T**(stop)---停止状态
>
> - **D**(isk sleep)---深度睡眠，不会被杀死
>
> - **X**(dead)---死亡状态
>
> - **Z**(zombie)---僵尸状态(进程已经退出，但仍保留该进程的信息，僵尸进程过多会导致内存泄漏问题)

- 进程并发---进程间切换

在一段时间内，多个进程在同一个CPU下采用进程切换的方式进行，让多个进程都得以推进

- 进程并行

同一时刻，多个进程在多个CPU下分别进行

- 硬件上下文

进程在运行期间在CPU寄存器上产生的数据

切换的时候将数据保存，返回时被恢复

硬件上下文被保存在PCB中

- 查看进程的两种方式

1.ps axj

2.查看proc目录

- 获取pid的方法

有pid就能实现进程调度

**获取当前进程pid：** `getpid()`

**获取父进程pid：** `getppid()`

- 外壳程序

操作系统通过外壳向用户传输数据，用户通过外壳向操作系统输入数据

>Windows系统的外壳是：窗口界面
>
>Linux系统的外壳是：终端命令行

shell：外壳程序的统称

bash（命令行解释器）：本身就是进程，为Linux系统下的父进程，可以创建子进程

- 创建子进程

关键字：fork（系统调用）

```C
pid_t id = fork();  //当id = 0时，表示创建子进程成功，当id > 0时，表示正在进行父进程，id为子进程的pid

```

fork之后创建的子进程的代码是从父进程继承来的，即代码时共享的，但数据时各自私有的（写时拷贝）。因为代码是相同的，子进程的PCB中的内容大部分是和父进程PCB中的内容是一样的

- 孤儿进程

父进程提前退出，而子进程还在，子进程就会被1号进程领养，即子进程的ppid = 1

- 修改进程

关键字：kill

查看kill手册：`kill -l`

### 进程的优先级（PRI）

- 取值范围：60~99

**优先级值越小越早被执行，值越小进程优先级越高**

- **查看优先级命令：**ps -l

操作系统会在链表中找优先级最高的进程，只要该程序的状态是非r状态，操作系统将其对应的代码块放在CPU上执行

由于可能同时进行多个进程，若挨个查找链表中的结构体会浪费太多时间，则操作系统会有两条链表，一条用于存放r状态的进程（可执行队列），一条用于存放非r状态的进程

- **修正值nice**

取值范围：-20~19

PRI（new） =PRI（OLD）+nice(修正值)

- **renice**---修改nice的值

`sudo renice 修改值 -p pid` 

- **nice**---在进程开始进行时，指明优先级

`sudo nice -n 修改值 `

- **top**

输入top->按 r->输入进程pid->输入nice值

欢迎交流~

转载请注明原地址：[Lucky-pxx的博客](http://www.bingoxin.top) » [点击阅读原文](http://www.bingoxin.top/2018/11/Java%E4%B8%AD%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B/),谢谢！